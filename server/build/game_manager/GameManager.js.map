{"version":3,"file":"GameManager.js","names":["levelData","_interopRequireWildcard","require","_MonsterController","_interopRequireDefault","_PlayerController","_ItemController","_NpcController","_MessageController","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","GameManager","exports","io","_classCallCheck2","monsterController","undefined","playerController","itemController","npcController","messageController","playerLocations","chestLocations","monsterLocations","npcLocations","_createClass2","key","value","setup","parseMapData","setupControllers","setupEventListeners","MonsterController","PlayerController","ItemController","NpcController","MessageController","_this","layers","forEach","layer","name","objects","obj","push","x","y","properties","spawner","_this2","on","socket","err","console","log","concat","message","emit","players","monsters","chests","items","npcs"],"sources":["../../src/game_manager/GameManager.js"],"sourcesContent":["import * as levelData from \"../../public/assets/level/new_level.json\";\n\nimport MonsterController from \"./controllers/MonsterController.js\";\nimport PlayerController from \"./controllers/PlayerController.js\";\nimport ItemController from \"./controllers/ItemController.js\";\nimport NpcController from \"./controllers/NpcController.js\";\nimport MessageController from \"./controllers/MessageController.js\";\n\nexport default class GameManager {\n  constructor(io) {\n    this.io = io;\n\n    this.monsterController = undefined;\n    this.playerController = undefined;\n    this.itemController = undefined;\n    this.npcController = undefined;\n    this.messageController = undefined;\n\n    this.levelData = levelData;\n\n    this.playerLocations = [[200, 200]];\n    this.chestLocations = {};\n    this.monsterLocations = [];\n    this.npcLocations = [];\n  }\n\n  setup() {\n    this.parseMapData();\n    this.setupControllers();\n    this.setupEventListeners();\n  }\n\n  setupControllers() {\n    this.monsterController = new MonsterController(\n      this.io,\n      this.monsterLocations\n    );\n    this.playerController = new PlayerController(this.io, this.playerLocations);\n    this.itemController = new ItemController(this.io);\n    this.npcController = new NpcController(this.io, this.npcLocations);\n    this.messageController = new MessageController(this.io);\n  }\n\n  parseMapData() {\n    this.levelData = levelData;\n    this.levelData.layers.forEach((layer) => {\n      if (layer.name === \"player_locations\") {\n        layer.objects.forEach((obj) => {\n          this.playerLocations.push([obj.x, obj.y]);\n        });\n      } else if (layer.name === \"monster_locations\") {\n        layer.objects.forEach((obj) => {\n          this.monsterLocations.push([obj.x, obj.y]);\n        });\n      } else if (layer.name === \"chest_locations\") {\n        layer.objects.forEach((obj) => {\n          if (this.chestLocations[obj.properties.spawner]) {\n            this.chestLocations[obj.properties.spawner].push([obj.x, obj.y]);\n          } else {\n            this.chestLocations[obj.properties.spawner] = [[obj.x, obj.y]];\n          }\n        });\n      } else if (layer.name === \"npc_locations\") {\n        layer.objects.forEach((obj) => {\n          if (this.npcLocations[obj.properties.spawner]) {\n            this.npcLocations.push([obj.x, obj.y]);\n          } else {\n            this.npcLocations.push([obj.x, obj.y]);\n          }\n        });\n      }\n    });\n  }\n\n  setupEventListeners() {\n    this.io.on(\"connection\", (socket) => {\n      socket.on(\"connect_error\", (err) => {\n        console.log(`connect_error due to ${err.message}`);\n      });\n\n      this.monsterController.setupEventListeners(socket);\n      this.itemController.setupEventListeners(socket);\n      this.npcController.setupEventListeners(socket);\n      this.playerController.setupEventListeners(socket);\n      this.messageController.setupEventListeners(socket);\n\n      socket.on(\"currents\", () => {\n        socket.emit(\"currentPlayers\", this.playerController.players);\n        socket.emit(\"currentMonsters\", this.monsterController.monsters);\n        socket.emit(\"currentChests\", this.itemController.chests);\n        socket.emit(\"currentItems\", this.itemController.items);\n        socket.emit(\"currentNpcs\", this.npcController.npcs);\n      });\n\n      // player connected to our game\n      console.log(\"player connected to our game\");\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]}