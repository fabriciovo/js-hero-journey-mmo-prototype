{"version":3,"file":"MessageController.js","names":["_jsonwebtoken","_interopRequireDefault","require","_ChatModel","MessageController","exports","io","_classCallCheck2","_createClass2","key","value","setupEventListeners","socket","_sendMessage","_this","on","_ref","_asyncToGenerator2","_regenerator","mark","_callee","message","token","decoded","_decoded$user","email","name","wrap","_callee$","_context","prev","next","jwt","verify","process","env","JWT_SECRET","user","ChatModel","create","emit","t0","console","log","stop","_x","_x2","apply","arguments"],"sources":["../../../src/game_manager/controllers/MessageController.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\n\nimport ChatModel from \"../../models/ChatModel.js\";\nexport default class MessageController {\n  constructor(io) {\n    this.io = io;\n  }\n\n  setupEventListeners(socket) {\n    this._sendMessage(socket);\n  }\n\n  _sendMessage(socket) {\n    socket.on(\"sendMessage\", async (message, token) => {\n      try {\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\n        const { email, name } = decoded.user;\n        await ChatModel.create({ email, message });\n        this.io.emit(\"newMessage\", {\n          message,\n          name: name,\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    });\n  }\n}\n"],"mappings":";;;;;;;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAkD,IAC7BE,iBAAiB,GAAAC,OAAA;EACpC,SAAAD,kBAAYE,EAAE,EAAE;IAAA,IAAAC,gBAAA,mBAAAH,iBAAA;IACd,IAAI,CAACE,EAAE,GAAGA,EAAE;EACd;EAAC,WAAAE,aAAA,aAAAJ,iBAAA;IAAAK,GAAA;IAAAC,KAAA,EAED,SAAAC,oBAAoBC,MAAM,EAAE;MAC1B,IAAI,CAACC,YAAY,CAACD,MAAM,CAAC;IAC3B;EAAC;IAAAH,GAAA;IAAAC,KAAA,EAED,SAAAG,aAAaD,MAAM,EAAE;MAAA,IAAAE,KAAA;MACnBF,MAAM,CAACG,EAAE,CAAC,aAAa;QAAA,IAAAC,IAAA,OAAAC,kBAAA,2BAAAC,YAAA,YAAAC,IAAA,CAAE,SAAAC,QAAOC,OAAO,EAAEC,KAAK;UAAA,IAAAC,OAAA,EAAAC,aAAA,EAAAC,KAAA,EAAAC,IAAA;UAAA,OAAAR,YAAA,YAAAS,IAAA,UAAAC,SAAAC,QAAA;YAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cAAA;gBAAAF,QAAA,CAAAC,IAAA;gBAEpCP,OAAO,GAAGS,wBAAG,CAACC,MAAM,CAACX,KAAK,EAAEY,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;gBAAAZ,aAAA,GACjCD,OAAO,CAACc,IAAI,EAA5BZ,KAAK,GAAAD,aAAA,CAALC,KAAK,EAAEC,IAAI,GAAAF,aAAA,CAAJE,IAAI;gBAAAG,QAAA,CAAAE,IAAA;gBAAA,OACbO,qBAAS,CAACC,MAAM,CAAC;kBAAEd,KAAK,EAALA,KAAK;kBAAEJ,OAAO,EAAPA;gBAAQ,CAAC,CAAC;cAAA;gBAC1CP,KAAI,CAACR,EAAE,CAACkC,IAAI,CAAC,YAAY,EAAE;kBACzBnB,OAAO,EAAPA,OAAO;kBACPK,IAAI,EAAEA;gBACR,CAAC,CAAC;gBAACG,QAAA,CAAAE,IAAA;gBAAA;cAAA;gBAAAF,QAAA,CAAAC,IAAA;gBAAAD,QAAA,CAAAY,EAAA,GAAAZ,QAAA;gBAEHa,OAAO,CAACC,GAAG,CAAAd,QAAA,CAAAY,EAAM,CAAC;cAAC;cAAA;gBAAA,OAAAZ,QAAA,CAAAe,IAAA;YAAA;UAAA,GAAAxB,OAAA;QAAA,CAEtB;QAAA,iBAAAyB,EAAA,EAAAC,GAAA;UAAA,OAAA9B,IAAA,CAAA+B,KAAA,OAAAC,SAAA;QAAA;MAAA,IAAC;IACJ;EAAC;AAAA","ignoreList":[]}